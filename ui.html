<style>
  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
      Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
  }

  button {
    border: none;
    margin: 0;
    padding: 0;
    width: auto;
    overflow: visible;
    background: transparent;
    /* inherit font & color from ancestor */
    color: inherit;
    font: inherit;
    /* Normalize `line-height`. Cannot be changed from `normal` in Firefox 4+. */
    line-height: normal;
    /* Corrects font smoothing for webkit */
    -webkit-font-smoothing: inherit;
    -moz-osx-font-smoothing: inherit;
    /* Corrects inability to style clickable `input` types in iOS */
    -webkit-appearance: none;
  }
  /* Remove excess padding and border in Firefox 4+ */
  button::-moz-focus-inner {
    border: 0;
    padding: 0;
  }

  button {
    display: grid;
    place-items: center;
    padding-left: 1rem;
    padding-right: 1rem;
    padding-top: 0.5rem;
    padding-bottom: 0.5rem;
    width: 100%;
    font-size: 12px;
  }

  div {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    padding-top: 0.25rem;
  }

  div.vertical {
    display: block;
  }

  p {
    font-size: smaller;
    color: darkslategray;
  }

  span.small {
    font-size: smaller;
    color: darkslategray;
    margin-bottom: 0.25rem;
  }

  input {
    width: 100%;
    height: 40px;
    border-radius: 8px;
    padding: 8px;
    background-color: white;
    color: rgb(87, 87, 87);
    font-weight: 500;
    box-shadow: none;
    outline: none;
    border: 2px solid darkgrey;
    margin-right: 0.25rem;
  }
  input:active {
    border: 2px solid #17a0fb;
  }
  input:focus {
    border: 2px solid #17a0fb;
  }
  select {
    width: 100%;
    height: 40px;
    border-radius: 8px;
    padding: 8px;
    background-color: white;
    color: rgb(87, 87, 87);
    font-weight: 500;
    box-shadow: none;
    outline: none;
    border: 2px solid darkgrey;
  }
  select:first-of-type {
    margin-right: 0.25rem;
  }
  select:active {
    border: 2px solid #17a0fb;
  }
  select:focus {
    border: 2px solid #17a0fb;
  }
  .primary {
    margin-right: 0.25rem;
    background-color: #17a0fb;
    color: white;
    height: 40px;
    font-weight: 600;
    border-radius: 8px;
    box-shadow: none;
    outline: none;
    border: none;
    transition: all 0.1s ease-in-out;
  }
  .secondary {
    margin-right: 0.25rem;
    background-color: rgb(238, 237, 237);
    color: rgb(87, 87, 87);
    height: 40px;
    font-weight: 500;
    border-radius: 8px;
    box-shadow: none;
    outline: none;
    transition: all 0.1s ease-in-out;
  }
  .textStyle {
    background: none;
    color: #17a0fb;
    width: 40px;
    font-weight: 600;
    font-size: small;
  }
  .primary:last-of-type {
    margin-right: 0;
  }
  .primary:active {
    background-color: #0985d8;
  }
  .primary:focus {
    background-color: #0985d8;
  }
  .secondary:active {
    background-color: lightgray;
  }
  .primary:hover {
    background-color: #0985d8;
    transition: all 0.1s ease-in-out;
    cursor: pointer;
  }
  .secondary:hover {
    background-color: lightgray;
    transition: all 0.1s ease-in-out;
    cursor: pointer;
  }
  .secondary:focus {
    background-color: lightgray;
  }
  .textStyle:active {
    color: #0985d8;
  }
  .textStyle:hover {
    color: #0985d8;
    transition: all 0.1s ease-in-out;
    cursor: pointer;
  }
  .textStyle:focus {
    color: #0985d8;
    border-bottom: 1px solid #0985d8;
  }
  .xs {
    font-size: x-small;
    margin-top: 5px;
    color: darkslategray;
  }
  .sm {
    font-size: small;
    padding-bottom: 0;
    margin-bottom: 10px;
    color: darkslategray;
  }
  .h-6 {
    height: 1rem;
  }
  .w-6 {
    height: 1rem;
  }
  .icon {
    width: 50px;
  }
  .justify-end {
    justify-content: space-between;
  }
  .mb-0 {
    margin-bottom: 0;
  }

  /* The switch - the box around the slider */
  .switch {
    position: relative;
    display: inline-block;
    width: 40px;
    height: 24px;
  }

  /* Hide default HTML checkbox */
  .switch input {
    opacity: 0;
    width: 0;
    height: 0;
  }

  /* The slider */
  .slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #d5d6d7;
    -webkit-transition: 0.4s;
    transition: 0.4s;
  }

  .slider:before {
    position: absolute;
    content: "";
    height: 16px;
    width: 16px;
    left: 4px;
    bottom: 4px;
    background-color: white;
    -webkit-transition: 0.4s;
    transition: 0.4s;
  }

  input:checked + .slider {
    background-color: #17a0fb;
  }

  input:focus + .slider {
    box-shadow: 0 0 1px #0985d8;
  }

  input:checked + .slider:before {
    -webkit-transform: translateX(16px);
    -ms-transform: translateX(16px);
    transform: translateX(16px);
  }

  /* Rounded sliders */
  .slider.round {
    border-radius: 34px;
  }

  .slider.round:before {
    border-radius: 50%;
  }
</style>

<div class="justify-end mb-0">
  <p>Close plugin on completion</p>
  <label class="switch">
    <input type="checkbox" id="checkbox" />
    <span class="slider round"></span>
  </label>
</div>
<h5 style="margin-bottom: 0; margin-top: 0">Set constraints</h5>
<div>
  <div class="vertical">
    <div style="justify-content: flex-start">
      <svg
        width="16"
        height="16"
        viewBox="0 0 32 32"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        style="margin-bottom: 0.25rem; margin-right: 0.5rem"
      >
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M3.98 10C4.2451 10 4.46 10.2239 4.46 10.5V15.5H26.54V10.5C26.54 10.2239 26.7549 10 27.02 10C27.2851 10 27.5 10.2239 27.5 10.5V21.5C27.5 21.7761 27.2851 22 27.02 22C26.7549 22 26.54 21.7761 26.54 21.5V16.5H4.46V21.5C4.46 21.7761 4.2451 22 3.98 22C3.7149 22 3.5 21.7761 3.5 21.5V10.5C3.5 10.2239 3.7149 10 3.98 10Z"
          fill="#404B6A"
        />
      </svg>
      <span class="small">Horizontal</span>
    </div>
    <select id="horizontalConstraint" onchange="setHorizontalConstraint()">
      <option value="MIN">Left</option>
      <option value="MAX">Right</option>
      <option value="CENTER">Center</option>
      <option value="STRETCH">Left and Right</option>
      <option value="SCALE">Scale</option>
    </select>
  </div>
  <div class="vertical">
    <div style="justify-content: flex-start">
      <svg
        width="16"
        height="16"
        viewBox="0 0 32 32"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        style="margin-bottom: 0.25rem"
      >
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M10 4.48C10 4.2149 10.2239 4 10.5 4L21.5 4C21.7761 4 22 4.2149 22 4.48C22 4.7451 21.7761 4.96 21.5 4.96L16.5 4.96L16.5 27.04H21.5C21.7761 27.04 22 27.2549 22 27.52C22 27.7851 21.7761 28 21.5 28H10.5C10.2239 28 10 27.7851 10 27.52C10 27.2549 10.2239 27.04 10.5 27.04H15.5L15.5 4.96L10.5 4.96C10.2239 4.96 10 4.7451 10 4.48Z"
          fill="#404B6A"
        />
      </svg>
      <span class="small">Vertical</span>
    </div>
    <select id="verticalConstraint" onchange="setVerticalConstraint()">
      <option value="MIN">Top</option>
      <option value="MAX">Bottom</option>
      <option value="CENTER">Center</option>
      <option value="STRETCH">Top and Bottom</option>
      <option value="SCALE">Scale</option>
    </select>
  </div>
</div>
<h5 style="margin-bottom: 0">Scale</h5>
<div>
  <input
    name="scalePercent"
    type="text"
    id="scaleAmount"
    value=""
    placeholder="Scale (%)"
    onchange="setValues()"
  />
  <button id="scaleByPercent" class="primary">Scale</button>
</div>

<div>
  <input
    type="text"
    name="scaleWidth"
    id="scaleWidth"
    value=""
    placeholder="Width (px)"
    onchange="setWidthValues()"
  />
  <button id="scaleByWidth" class="primary icon">
    <span
      ><svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-6 w-6"
        fill="none"
        viewBox="0 0 24 24"
        stroke="#fff"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"
        />
      </svg>
    </span>
  </button>
  <input
    type="text"
    name="scaleHeight"
    id="scaleHeight"
    value=""
    placeholder="Height (px)"
    onchange="setHeightValues()"
  />
  <button id="scaleByHeight" class="primary icon">
    <span
      ><svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-6 w-6"
        fill="none"
        viewBox="0 0 24 24"
        stroke="#fff"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"
        />
      </svg>
    </span>
  </button>
</div>

<script>
  /* Variables */

  const scaleTextBox = document.getElementById("scaleAmount");
  let scaleAmount = Number(scaleTextBox.value ?? 0);

  const scaleWidthTextBox = document.getElementById("scaleWidth");
  let scaleWidthAmount = Number(scaleWidthTextBox.value ?? 0);

  const scaleHeightTextBox = document.getElementById("scaleHeight");
  let scaleHeightAmount = Number(scaleHeightTextBox.value ?? 0);

  const horizontalConstraints = document.getElementById("horizontalConstraint");
  let horizontalConstraint = horizontalConstraints.value;

  const verticalConstraints = document.getElementById("verticalConstraint");
  let verticalConstraint = verticalConstraints.value;

  /* Functions */

  function setValues() {
    scaleAmount = Number(scaleTextBox.value ?? 0);
  }

  function setWidthValues() {
    scaleWidthAmount = Number(scaleWidthTextBox.value ?? 0);
  }

  function setHeightValues() {
    scaleHeightAmount = Number(scaleHeightTextBox.value ?? 0);
  }

  function setHorizontalConstraint() {
    horizontalConstraint = horizontalConstraints.value;
    parent.postMessage(
      {
        pluginMessage: {
          type: ["scale-value", "scale-height-value", "scale-width-value"],
          horizontalConstraint,
        },
      },
      "*"
    );
  }

  function setVerticalConstraint() {
    verticalConstraint = verticalConstraints.value;
    parent.postMessage(
      {
        pluginMessage: {
          type: ["scale-value", "scale-height-value", "scale-width-value"],
          verticalConstraint,
        },
      },
      "*"
    );
  }

  function sendParentConstraints() {
    setVerticalConstraint();
    setHorizontalConstraint();
    console.log(horizontalConstraint, verticalConstraint, "from UI");
  }

  const checkbox = document.getElementById("checkbox");
  let checkboxOn = checkbox.hasAttribute("checked");
  checkbox.onclick = () => {
    checkbox.toggleAttribute("checked");
    checkboxOn = checkbox.hasAttribute("checked");
    console.log(checkboxOn);
  };

  document.getElementById("scaleByPercent").onclick = () => {
    parent.postMessage(
      {
        pluginMessage: {
          type: "scale-value",
          scaleAmount,
          horizontalConstraint,
          verticalConstraint,
          checkboxOn,
        },
      },
      "*"
    );
  };

  document
    .querySelector('input[name="scalePercent"]')
    .addEventListener("keyup", function (e) {
      if (e.key === "Enter") {
        parent.postMessage(
          {
            pluginMessage: {
              type: "scale-value",
              scaleAmount,
              horizontalConstraint,
              verticalConstraint,
              checkboxOn,
            },
          },
          "*"
        );
      }
    });

  document.getElementById("scaleByWidth").onclick = () => {
    parent.postMessage(
      {
        pluginMessage: {
          type: "scale-width-value",
          scaleWidthAmount,
          horizontalConstraint,
          verticalConstraint,
          checkboxOn,
        },
      },
      "*"
    );
  };

  document
    .querySelector('input[name="scaleWidth"]')
    .addEventListener("keyup", function (e) {
      if (e.key === "Enter") {
        parent.postMessage(
          {
            pluginMessage: {
              type: "scale-width-value",
              scaleWidthAmount,
              horizontalConstraint,
              verticalConstraint,
              checkboxOn,
            },
          },
          "*"
        );
      }
    });

  document.getElementById("scaleByHeight").onclick = () => {
    parent.postMessage(
      {
        pluginMessage: {
          type: "scale-height-value",
          scaleHeightAmount,
          horizontalConstraint,
          verticalConstraint,
          checkboxOn,
        },
      },
      "*"
    );
  };

  document
    .querySelector('input[name="scaleHeight"]')
    .addEventListener("keyup", function (e) {
      if (e.key === "Enter") {
        parent.postMessage(
          {
            pluginMessage: {
              type: "scale-height-value",
              scaleHeightAmount,
              horizontalConstraint,
              verticalConstraint,
              checkboxOn,
            },
          },
          "*"
        );
      }
    });
</script>
